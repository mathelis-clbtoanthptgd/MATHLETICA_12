<!doctype html>
<html lang="vi">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jack And Jill - Water Puzzle Game</title>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&amp;family=Quicksand:wght@400;600;700&amp;display=swap" rel="stylesheet">
  <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(135deg, #FAF0E6 0%, #B0E0E6 100%);
            min-height: 100%;
            color: #37474F;
            position: relative;
            overflow-x: hidden;
        }

        /* Animated Background Elements */
        .background-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .clouds {
            position: absolute;
            top: 10%;
            width: 100%;
            height: 200px;
        }

        .cloud {
            position: absolute;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 50px;
            opacity: 0.6;
        }

        .cloud:before,
        .cloud:after {
            content: '';
            position: absolute;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 50px;
        }

        .cloud1 {
            width: 80px;
            height: 40px;
            top: 20px;
            left: -100px;
            animation: driftRight 25s linear infinite;
        }

        .cloud1:before {
            width: 50px;
            height: 50px;
            top: -25px;
            left: 10px;
        }

        .cloud1:after {
            width: 60px;
            height: 40px;
            top: -15px;
            right: 10px;
        }

        .cloud2 {
            width: 60px;
            height: 30px;
            top: 60px;
            left: -80px;
            animation: driftRight 30s linear infinite 5s;
        }

        .cloud2:before {
            width: 40px;
            height: 40px;
            top: -20px;
            left: 8px;
        }

        .cloud2:after {
            width: 50px;
            height: 30px;
            top: -10px;
            right: 8px;
        }

        .cloud3 {
            width: 100px;
            height: 50px;
            top: 10px;
            left: -120px;
            animation: driftRight 35s linear infinite 10s;
        }

        .cloud3:before {
            width: 60px;
            height: 60px;
            top: -30px;
            left: 15px;
        }

        .cloud3:after {
            width: 70px;
            height: 50px;
            top: -20px;
            right: 15px;
        }

        @keyframes driftRight {
            0% { transform: translateX(-100px); }
            100% { transform: translateX(calc(100vw + 100px)); }
        }

        .grass-elements {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 150px;
        }

        .grass {
            position: absolute;
            bottom: 0;
            width: 3px;
            background: linear-gradient(to top, #228B22, #7CFC00);
            border-radius: 2px 2px 0 0;
            animation: sway 3s ease-in-out infinite;
        }

        .grass:nth-child(1) { left: 10%; height: 30px; animation-delay: 0s; }
        .grass:nth-child(2) { left: 15%; height: 25px; animation-delay: 0.5s; }
        .grass:nth-child(3) { left: 25%; height: 35px; animation-delay: 1s; }
        .grass:nth-child(4) { left: 35%; height: 28px; animation-delay: 1.5s; }
        .grass:nth-child(5) { left: 65%; height: 32px; animation-delay: 2s; }
        .grass:nth-child(6) { left: 75%; height: 26px; animation-delay: 2.5s; }
        .grass:nth-child(7) { left: 85%; height: 30px; animation-delay: 0.8s; }
        .grass:nth-child(8) { left: 90%; height: 24px; animation-delay: 1.3s; }

        @keyframes sway {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(2deg); }
            75% { transform: rotate(-2deg); }
        }

        .pond-area {
            position: absolute;
            bottom: 20px;
            right: 10%;
            width: 120px;
            height: 80px;
            background: radial-gradient(ellipse, rgba(0, 123, 255, 0.3), rgba(0, 123, 255, 0.1));
            border-radius: 50%;
            animation: shimmer 4s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.05); }
        }

        /* Ambient decorative elements */
        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .butterfly {
            position: absolute;
            font-size: 1.5rem;
            animation: butterflyFly 15s ease-in-out infinite;
        }

        .butterfly:nth-child(1) {
            top: 20%;
            left: -50px;
            animation-delay: 0s;
        }

        .butterfly:nth-child(2) {
            top: 60%;
            left: -50px;
            animation-delay: 7s;
        }

        @keyframes butterflyFly {
            0% { 
                transform: translateX(-50px) translateY(0px) rotate(0deg); 
                opacity: 0; 
            }
            10% { 
                opacity: 1; 
            }
            25% { 
                transform: translateX(25vw) translateY(-20px) rotate(10deg); 
            }
            50% { 
                transform: translateX(50vw) translateY(10px) rotate(-5deg); 
            }
            75% { 
                transform: translateX(75vw) translateY(-15px) rotate(15deg); 
            }
            90% { 
                opacity: 1; 
            }
            100% { 
                transform: translateX(calc(100vw + 50px)) translateY(0px) rotate(0deg); 
                opacity: 0; 
            }
        }

        .floating-leaf {
            position: absolute;
            font-size: 1.2rem;
            animation: leafFloat 20s ease-in-out infinite;
            opacity: 0.6;
        }

        .floating-leaf:nth-child(3) {
            top: 30%;
            right: -30px;
            animation-delay: 3s;
        }

        .floating-leaf:nth-child(4) {
            top: 70%;
            right: -30px;
            animation-delay: 12s;
        }

        @keyframes leafFloat {
            0% { 
                transform: translateX(30px) translateY(0px) rotate(0deg); 
                opacity: 0; 
            }
            10% { 
                opacity: 0.6; 
            }
            25% { 
                transform: translateX(-20vw) translateY(15px) rotate(-45deg); 
            }
            50% { 
                transform: translateX(-40vw) translateY(-10px) rotate(-90deg); 
            }
            75% { 
                transform: translateX(-60vw) translateY(20px) rotate(-135deg); 
            }
            90% { 
                opacity: 0.6; 
            }
            100% { 
                transform: translateX(-100vw) translateY(0px) rotate(-180deg); 
                opacity: 0; 
            }
        }

        /* Header cloud decoration */
        .header-cloud {
            position: absolute;
            top: 10px;
            right: 100px;
            font-size: 1.5rem;
            opacity: 0.4;
            animation: headerCloudDrift 8s ease-in-out infinite;
        }

        @keyframes headerCloudDrift {
            0%, 100% { 
                transform: translateX(0px) translateY(0px); 
                opacity: 0.4; 
            }
            50% { 
                transform: translateX(10px) translateY(-5px); 
                opacity: 0.6; 
            }
        }

        html {
            height: 100%;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100%;
            display: flex;
            flex-direction: column;
        }

        .page {
            display: none;
            flex: 1;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.8s ease-in-out;
        }

        .page.active {
            display: flex;
            flex-direction: column;
            opacity: 1;
            transform: translateY(0);
            animation: dissolveIn 1.2s ease-out;
        }

        .page.fade-out {
            opacity: 0;
            transform: scale(0.95);
            filter: blur(5px);
            transition: all 0.8s ease-in;
        }

        @keyframes slideInFade {
            0% { 
                opacity: 0; 
                transform: translateY(30px) scale(0.95); 
            }
            60% { 
                opacity: 0.8; 
                transform: translateY(-5px) scale(1.02); 
            }
            100% { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }

        @keyframes dissolveIn {
            0% { 
                opacity: 0; 
                filter: blur(15px);
                transform: scale(0.85);
            }
            50% {
                opacity: 0.7;
                filter: blur(5px);
                transform: scale(0.95);
            }
            100% { 
                opacity: 1; 
                filter: blur(0px);
                transform: scale(1);
            }
        }

        @keyframes riseUp {
            0% {
                opacity: 0;
                transform: translateY(40px) scale(0.9);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes popIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.1);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes fadeInDelayed {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Welcome Page Styles */
        .welcome-page {
            text-align: center;
            justify-content: center;
            align-items: center;
            padding: 40px 20px;
        }

        .game-title {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
            font-weight: 700;
            color: #5D4037;
            text-shadow: 2px 2px 4px rgba(139, 69, 19, 0.3);
            margin-bottom: 10px;
            animation: riseUp 1.5s ease-out;
            position: relative;
        }

        .game-title::after {
            content: '🌿';
            position: absolute;
            top: -10px;
            right: -30px;
            font-size: 2rem;
            animation: float 3s ease-in-out infinite;
        }

        .subtitle {
            font-family: 'Quicksand', sans-serif;
            font-size: 1.2rem;
            color: #37474F;
            margin-bottom: 40px;
            font-style: italic;
            animation: fadeInDelayed 1.8s ease-out;
            animation-delay: 0.5s;
            animation-fill-mode: both;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
        }

        .name-input-container {
            margin: 30px 0;
            position: relative;
            animation: fadeInDelayed 2s ease-out;
            animation-delay: 1s;
            animation-fill-mode: both;
        }

        .name-input {
            padding: 15px 50px 15px 20px;
            font-size: 1.1rem;
            border: 3px dashed #8B4513;
            border-radius: 25px;
            background: #FEFCF5;
            color: #37474F;
            width: 100%;
            max-width: 300px;
            text-align: center;
            font-family: 'Quicksand', sans-serif;
            box-shadow: inset 0 2px 5px rgba(139, 69, 19, 0.1);
            transition: all 0.3s ease;
        }

        .name-input:focus {
            outline: none;
            border-color: #7CFC00;
            background: white;
            box-shadow: 0 0 15px rgba(124, 252, 0, 0.3);
        }

        .name-input::placeholder {
            color: rgba(55, 71, 79, 0.7);
            font-style: italic;
        }

        .name-input-container::after {
            content: '🌳';
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5rem;
            animation: treeFloat 4s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes treeFloat {
            0%, 100% { 
                transform: translateY(-50%) rotate(0deg); 
                opacity: 0.7; 
            }
            50% { 
                transform: translateY(-60%) rotate(2deg); 
                opacity: 1; 
            }
        }

        .start-btn {
            background: linear-gradient(45deg, #7CFC00, #32CD32);
            color: white;
            border: none;
            padding: 18px 40px;
            font-size: 1.3rem;
            font-weight: 700;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(124, 252, 0, 0.3);
            transition: all 0.3s ease;
            font-family: 'Quicksand', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            animation: fadeInDelayed 2.2s ease-out;
            animation-delay: 1.5s;
            animation-fill-mode: both;
            overflow: hidden;
        }

        .start-btn::before {
            content: '🌟';
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            animation: starTwinkle 2s ease-in-out infinite;
        }

        .start-btn::after {
            content: '🌟';
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            animation: starTwinkle 2s ease-in-out infinite;
            animation-delay: 1s;
        }

        .start-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(124, 252, 0, 0.4);
            background: linear-gradient(45deg, #32CD32, #7CFC00);
        }

        @keyframes starTwinkle {
            0%, 100% { 
                opacity: 0.5; 
                transform: translateY(-50%) scale(0.8); 
            }
            50% { 
                opacity: 1; 
                transform: translateY(-50%) scale(1.2); 
            }
        }

        /* Game Page Styles */
        .game-header {
            background: rgba(255, 255, 255, 0.9);
            padding: 15px 20px;
            border-radius: 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 2px solid #8B4513;
            flex-wrap: wrap;
            gap: 10px;
        }

        .player-info {
            font-weight: 600;
            color: #5D4037;
        }

        .timer {
            font-weight: 700;
            color: #007BFF;
            font-size: 1.1rem;
        }

        .buckets-container {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .bucket {
            text-align: center;
            position: relative;
        }

        .bucket-visual {
            width: 120px;
            height: 150px;
            background: #8B4513;
            border-radius: 0 0 20px 20px;
            position: relative;
            margin: 0 auto 15px;
            border: 4px solid #654321;
            overflow: hidden;
        }

        .water {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(180deg, #007BFF, #0056b3);
            transition: height 0.5s ease;
            border-radius: 0 0 16px 16px;
            overflow: hidden;
        }

        .water::before {
            content: '';
            position: absolute;
            top: -2px;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, 
                rgba(255, 255, 255, 0.3) 0%, 
                rgba(255, 255, 255, 0.7) 50%, 
                rgba(255, 255, 255, 0.3) 100%);
            animation: waterRipple 2s ease-in-out infinite;
        }

        .water::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.2) 2px, transparent 2px),
                radial-gradient(circle at 70% 60%, rgba(255, 255, 255, 0.15) 1px, transparent 1px),
                radial-gradient(circle at 40% 80%, rgba(255, 255, 255, 0.1) 1.5px, transparent 1.5px);
            animation: sparkle 3s ease-in-out infinite;
        }

        @keyframes waterRipple {
            0%, 100% { 
                transform: translateX(-100%); 
                opacity: 0; 
            }
            50% { 
                transform: translateX(0%); 
                opacity: 1; 
            }
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.8; }
        }

        .bucket-label {
            font-weight: 700;
            color: #5D4037;
            margin-bottom: 5px;
        }

        .bucket-capacity {
            font-size: 0.9rem;
            color: #666;
            transition: all 0.3s ease;
        }

        .bucket-capacity.changed {
            animation: popUp 0.6s ease-out;
            color: #007BFF;
            font-weight: 700;
        }

        @keyframes popUp {
            0% { 
                transform: scale(1); 
                color: #666; 
            }
            50% { 
                transform: scale(1.2); 
                color: #007BFF; 
            }
            100% { 
                transform: scale(1); 
                color: #007BFF; 
            }
        }

        .bucket-visual.changed {
            animation: bucketShake 0.5s ease-out;
        }

        @keyframes bucketShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-3px) rotate(-1deg); }
            75% { transform: translateX(3px) rotate(1deg); }
        }

        .actions-container {
            background: rgba(255, 255, 255, 0.9);
            padding: 25px;
            border-radius: 20px;
            border: 2px solid #8B4513;
            margin: 20px 0;
        }

        .actions-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.4rem;
            color: #5D4037;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .action-btn {
            background: linear-gradient(45deg, #8B4513, #A0522D);
            color: #FFD700;
            border: 3px solid #654321;
            padding: 12px 20px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s ease;
            font-family: 'Quicksand', sans-serif;
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3);
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            font-size: 0.95rem;
        }

        .action-btn::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            right: 2px;
            bottom: 2px;
            background: 
                linear-gradient(45deg, transparent 30%, rgba(255, 215, 0, 0.1) 50%, transparent 70%),
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 2px,
                    rgba(101, 67, 33, 0.3) 2px,
                    rgba(101, 67, 33, 0.3) 4px
                );
            border-radius: 12px;
            pointer-events: none;
        }

        .action-btn::after {
            content: '🌿';
            position: absolute;
            top: 2px;
            right: 8px;
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .action-btn:hover {
            transform: translateY(-2px) scale(1.05);
            background: linear-gradient(45deg, #7CFC00, #32CD32);
            color: #37474F;
            border-color: #228B22;
            box-shadow: 0 8px 25px rgba(124, 252, 0, 0.4);
            animation: buttonGlow 0.6s ease-in-out;
        }

        .action-btn:hover::after {
            content: '✨';
            animation: sparkleRotate 0.6s ease-in-out;
        }

        .action-btn:active {
            transform: translateY(0px) scale(0.98);
            transition: all 0.1s ease;
        }

        .action-btn.pulse {
            animation: pulse 2s ease-in-out infinite;
        }

        .action-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            animation: none;
            color: #666;
            border-color: #999;
        }

        @keyframes sparkleRotate {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.3); }
            100% { transform: rotate(360deg) scale(1); }
        }

        @keyframes buttonGlow {
            0% { box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3); }
            50% { box-shadow: 0 8px 30px rgba(255, 215, 0, 0.6); }
            100% { box-shadow: 0 8px 25px rgba(255, 215, 0, 0.5); }
        }

        @keyframes pulse {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3); 
            }
            50% { 
                transform: scale(1.03); 
                box-shadow: 0 6px 20px rgba(255, 215, 0, 0.5); 
            }
        }

        .rules-container {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 20px;
            border: 2px solid #7CFC00;
            margin: 20px 0;
        }

        .rules-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            color: #5D4037;
            margin-bottom: 15px;
            text-align: center;
            font-weight: 600;
        }

        .story-text {
            line-height: 1.6;
            margin-bottom: 20px;
            text-align: justify;
        }

        .rules-list {
            list-style: none;
            padding: 0;
        }

        .rules-list li {
            margin: 10px 0;
            padding-left: 25px;
            position: relative;
        }

        .rules-list li:before {
            content: "🎯";
            position: absolute;
            left: 0;
        }

        /* Victory Modal - Pastoral Celebration */
        .victory-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(8px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: modalFadeIn 0.8s ease-out;
        }

        .victory-content {
            background: linear-gradient(135deg, #FAF0E6 0%, #FEFCF5 50%, #FAF0E6 100%);
            padding: 50px 40px 40px 40px;
            border-radius: 25px;
            text-align: center;
            border: 8px solid #8B4513;
            box-shadow: 
                0 15px 40px rgba(0, 0, 0, 0.4),
                inset 0 0 30px rgba(124, 252, 0, 0.1),
                0 0 0 4px #654321,
                0 0 0 8px #8B4513;
            max-width: 500px;
            margin: 20px;
            position: relative;
            animation: pastoralPopIn 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            overflow: visible;
        }

        /* Decorative Frame Elements */
        .victory-content::before {
            content: '';
            position: absolute;
            top: -15px;
            left: -15px;
            right: -15px;
            bottom: -15px;
            background: 
                repeating-conic-gradient(from 0deg at 50% 50%, 
                    rgba(139, 69, 19, 0.1) 0deg 45deg, 
                    rgba(124, 252, 0, 0.1) 45deg 90deg,
                    rgba(255, 215, 0, 0.1) 90deg 135deg,
                    rgba(139, 69, 19, 0.1) 135deg 180deg);
            border-radius: 35px;
            z-index: -1;
            animation: frameGlow 3s ease-in-out infinite;
        }

        /* Top Bunting Flags */
        .victory-content::after {
            content: '🎪🎭🎨🎪🎭🎨🎪';
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.2rem;
            opacity: 0.8;
            animation: buntingWave 4s ease-in-out infinite;
            white-space: nowrap;
        }

        /* Corner Lanterns */
        .victory-lantern-left {
            position: absolute;
            top: -20px;
            left: -20px;
            font-size: 2rem;
            animation: lanternGlow 2s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.6));
        }

        .victory-lantern-right {
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 2rem;
            animation: lanternGlow 2s ease-in-out infinite;
            animation-delay: 1s;
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.6));
        }

        /* Bottom Corner Mushrooms */
        .victory-mushrooms-left {
            position: absolute;
            bottom: -15px;
            left: -10px;
            font-size: 1.5rem;
            animation: mushroomBob 3s ease-in-out infinite;
        }

        .victory-mushrooms-right {
            position: absolute;
            bottom: -15px;
            right: -10px;
            font-size: 1.5rem;
            animation: mushroomBob 3s ease-in-out infinite;
            animation-delay: 1.5s;
        }

        .victory-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.8rem;
            color: #5D4037;
            margin: 20px 0 25px 0;
            text-shadow: 
                2px 2px 4px rgba(255, 255, 255, 0.8),
                0 0 20px rgba(255, 215, 0, 0.3);
            position: relative;
            font-weight: 700;
        }

        /* Golden Ribbon */
        .victory-ribbon {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2.5rem;
            animation: ribbonShine 2s ease-in-out infinite;
            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.8));
        }

        /* Trophy Cups */
        .victory-title::before {
            content: '🏆';
            position: absolute;
            left: -50px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2.2rem;
            animation: trophyBounce 2s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.6));
        }

        .victory-title::after {
            content: '🏆';
            position: absolute;
            right: -50px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2.2rem;
            animation: trophyBounce 2s ease-in-out infinite;
            animation-delay: 1s;
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.6));
        }

        .victory-info {
            margin: 18px 0;
            font-weight: 600;
            color: #37474F;
            background: rgba(255, 255, 255, 0.7);
            padding: 12px 20px;
            border-radius: 20px;
            border: 3px solid rgba(139, 69, 19, 0.3);
            box-shadow: 
                inset 0 2px 5px rgba(255, 255, 255, 0.5),
                0 4px 15px rgba(139, 69, 19, 0.2);
            position: relative;
            font-family: 'Quicksand', sans-serif;
        }

        .victory-info::before {
            content: '✨';
            position: absolute;
            left: 8px;
            top: 50%;
            transform: translateY(-50%);
            animation: sparkleRotate 3s linear infinite;
        }

        .victory-characters {
            margin: 25px 0;
            font-size: 3.5rem;
            animation: celebrationDance 2s ease-in-out infinite;
            filter: drop-shadow(0 0 20px rgba(124, 252, 0, 0.4));
        }

        .play-again-btn {
            background: linear-gradient(45deg, #8B4513, #A0522D);
            color: #FFD700;
            border: 4px solid #654321;
            padding: 18px 35px;
            font-size: 1.2rem;
            font-weight: 700;
            border-radius: 30px;
            cursor: pointer;
            margin-top: 25px;
            transition: all 0.3s ease;
            font-family: 'Quicksand', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            position: relative;
            box-shadow: 
                0 6px 20px rgba(139, 69, 19, 0.4),
                inset 0 2px 5px rgba(255, 215, 0, 0.3);
        }

        .play-again-btn::before {
            content: '🔄';
            margin-right: 10px;
            animation: buttonIconSpin 3s linear infinite;
            display: inline-block;
        }

        .play-again-btn::after {
            content: '';
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
        }

        .play-again-btn:hover {
            transform: translateY(-3px) scale(1.08);
            background: linear-gradient(45deg, #7CFC00, #32CD32);
            color: #37474F;
            border-color: #228B22;
            box-shadow: 
                0 10px 30px rgba(124, 252, 0, 0.5),
                inset 0 2px 8px rgba(255, 255, 255, 0.4);
        }

        /* Animations */
        @keyframes modalFadeIn {
            0% { 
                opacity: 0; 
                backdrop-filter: blur(0px);
            }
            100% { 
                opacity: 1; 
                backdrop-filter: blur(8px);
            }
        }

        @keyframes pastoralPopIn {
            0% {
                opacity: 0;
                transform: scale(0.3) rotate(-10deg);
                filter: blur(10px);
            }
            60% {
                opacity: 0.8;
                transform: scale(1.1) rotate(2deg);
                filter: blur(2px);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
                filter: blur(0px);
            }
        }

        @keyframes frameGlow {
            0%, 100% { 
                opacity: 0.3; 
                transform: rotate(0deg);
            }
            50% { 
                opacity: 0.6; 
                transform: rotate(1deg);
            }
        }

        @keyframes buntingWave {
            0%, 100% { 
                transform: translateX(-50%) translateY(0px); 
            }
            25% { 
                transform: translateX(-50%) translateY(-3px); 
            }
            75% { 
                transform: translateX(-50%) translateY(3px); 
            }
        }

        @keyframes lanternGlow {
            0%, 100% { 
                transform: scale(1) rotate(0deg); 
                filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.6));
            }
            50% { 
                transform: scale(1.1) rotate(5deg); 
                filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.9));
            }
        }

        @keyframes mushroomBob {
            0%, 100% { 
                transform: translateY(0px) scale(1); 
            }
            50% { 
                transform: translateY(-5px) scale(1.05); 
            }
        }

        @keyframes ribbonShine {
            0%, 100% { 
                transform: translateX(-50%) scale(1); 
                filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.8));
            }
            50% { 
                transform: translateX(-50%) scale(1.1); 
                filter: drop-shadow(0 0 25px rgba(255, 215, 0, 1));
            }
        }

        @keyframes trophyBounce {
            0%, 100% { 
                transform: translateY(-50%) scale(1) rotate(0deg); 
            }
            25% { 
                transform: translateY(-60%) scale(1.1) rotate(-5deg); 
            }
            75% { 
                transform: translateY(-40%) scale(1.05) rotate(5deg); 
            }
        }

        @keyframes sparkleRotate {
            0% { transform: translateY(-50%) rotate(0deg) scale(1); }
            25% { transform: translateY(-50%) rotate(90deg) scale(1.2); }
            50% { transform: translateY(-50%) rotate(180deg) scale(1); }
            75% { transform: translateY(-50%) rotate(270deg) scale(1.2); }
            100% { transform: translateY(-50%) rotate(360deg) scale(1); }
        }

        @keyframes celebrationDance {
            0%, 100% { 
                transform: translateY(0px) rotate(0deg) scale(1); 
            }
            25% { 
                transform: translateY(-15px) rotate(-8deg) scale(1.05); 
            }
            50% { 
                transform: translateY(-5px) rotate(0deg) scale(1.1); 
            }
            75% { 
                transform: translateY(-10px) rotate(8deg) scale(1.05); 
            }
        }

        @keyframes buttonIconSpin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes buttonStarTwinkle {
            0%, 100% { 
                opacity: 0.7; 
                transform: translateY(-50%) scale(0.8); 
            }
            50% { 
                opacity: 1; 
                transform: translateY(-50%) scale(1.3); 
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .game-title {
                font-size: 2.5rem;
            }
            
            .buckets-container {
                gap: 20px;
            }
            
            .bucket-visual {
                width: 100px;
                height: 125px;
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
            
            .game-header {
                flex-direction: column;
                text-align: center;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            .game-title {
                font-size: 2rem;
            }
            
            .victory-content {
                padding: 30px 20px;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body><!-- Animated Background Elements -->
  <div class="background-elements">
   <div class="clouds">
    <div class="cloud cloud1"></div>
    <div class="cloud cloud2"></div>
    <div class="cloud cloud3"></div>
   </div>
   <div class="grass-elements">
    <div class="grass"></div>
    <div class="grass"></div>
    <div class="grass"></div>
    <div class="grass"></div>
    <div class="grass"></div>
    <div class="grass"></div>
    <div class="grass"></div>
    <div class="grass"></div>
   </div>
   <div class="pond-area"></div>
  </div><!-- Floating Ambient Elements -->
  <div class="floating-elements">
   <div class="butterfly">
    🦋
   </div>
   <div class="butterfly">
    🦋
   </div>
   <div class="floating-leaf">
    🍃
   </div>
   <div class="floating-leaf">
    🍃
   </div>
  </div>
  <div class="container"><!-- Welcome Page -->
   <div id="welcomePage" class="page active welcome-page">
    <h1 class="game-title" id="gameTitle">Jack And Jill</h1>
    <p class="subtitle" id="gameSubtitle">Mathletica: Đố vui không thưởng #12</p>
    <div class="name-input-container"><input type="text" class="name-input" id="playerNameInput" placeholder="Nhập tên của bạn...">
    </div><button class="start-btn" onclick="startGame()">BẮT ĐẦU</button>
   </div><!-- Game Page -->
   <div id="gamePage" class="page">
    <div class="game-header">
     <div class="player-info">
      Người chơi: <span id="playerName">Bạn</span>
     </div>
     <div class="timer">
      ⏰ <span id="gameTimer">00:00</span>
     </div>
     <div class="header-cloud">
      ☁️
     </div>
    </div>
    <div class="rules-container">
     <h3 class="rules-title">🎯 ĐỀ BÀI &amp; LUẬT CHƠI</h3>
     <div class="story-text"><strong>Câu chuyện:</strong> Chuyến đi lên đồi tìm giếng nước của Jack và Jill đã chẳng mấy suôn sẻ. Tuy nhiên, sau cú ngã lộn nhào tưởng chừng như không may xuống sườn đồi bên kia, định mệnh lại dẫn lối họ đến một hồ nước trong vắt. Họ quyết định sẽ lấy nước từ đây.
     </div>
     <div class="story-text">
      Nhưng một thử thách oái oăm đã nảy sinh: họ cần đong chính xác <strong>7 lít nước</strong>. Vấn đề là, trong tay Jack chỉ có chiếc xô 3 lít nhỏ bé, và Jill thì giữ chiếc xô 5 lít.
     </div>
     <ul class="rules-list">
      <li><strong>Mục tiêu:</strong> Tổng số nước trong 2 xô = 7 lít</li>
      <li><strong>Đổ đầy:</strong> Lấy nước từ ao vào xô</li>
      <li><strong>Đổ hết:</strong> Đổ toàn bộ nước ra đất</li>
      <li><strong>Rót qua:</strong> Chuyển nước giữa các xô</li>
     </ul>
    </div>
    <div class="buckets-container">
     <div class="bucket">
      <div class="bucket-label">
       Xô Jack (3L)
      </div>
      <div class="bucket-visual">
       <div class="water" id="bucket3Water"></div>
      </div>
      <div class="bucket-capacity">
       <span id="bucket3Amount">0</span>/3 lít
      </div>
     </div>
     <div class="bucket">
      <div class="bucket-label">
       Xô Jill (5L)
      </div>
      <div class="bucket-visual">
       <div class="water" id="bucket5Water"></div>
      </div>
      <div class="bucket-capacity">
       <span id="bucket5Amount">0</span>/5 lít
      </div>
     </div>
    </div>
    <div class="actions-container">
     <h3 class="actions-title">Hành động</h3>
     <div class="action-buttons"><button class="action-btn" onclick="fillBucket(3)">Đổ đầy xô 3L</button> <button class="action-btn" onclick="fillBucket(5)">Đổ đầy xô 5L</button> <button class="action-btn" onclick="emptyBucket(3)">Đổ hết xô 3L</button> <button class="action-btn" onclick="emptyBucket(5)">Đổ hết xô 5L</button> <button class="action-btn" onclick="pourWater(3, 5)">Rót từ 3L sang 5L</button> <button class="action-btn" onclick="pourWater(5, 3)">Rót từ 5L sang 3L</button>
     </div>
    </div>
   </div>
  </div><!-- Victory Modal -->
  <div id="victoryModal" class="victory-modal">
   <div class="victory-content"><!-- Decorative Elements -->
    <div class="victory-lantern-left">
     🏮
    </div>
    <div class="victory-lantern-right">
     🏮
    </div>
    <div class="victory-ribbon">
     🎗️
    </div>
    <div class="victory-mushrooms-left">
     🍄🌸
    </div>
    <div class="victory-mushrooms-right">
     🌸🍄
    </div>
    <h2 class="victory-title">CHÚC MỪNG!</h2>
    <div class="victory-characters">
     👦👧
    </div>
    <div class="victory-info">
     Người chơi: <span id="victoryPlayerName">Bạn</span>
    </div>
    <div class="victory-info">
     Thời gian: <span id="victoryTime">00:00</span>
    </div>
    <div class="victory-info">
     Jack và Jill đã cùng bạn tìm ra cách đong chính xác 7 lít nước!
    </div><button class="play-again-btn" onclick="resetGame()">Chơi lại</button>
   </div>
  </div>
  <script>
        // Game state
        let gameState = {
            bucket3: 0,
            bucket5: 0,
            playerName: '',
            startTime: null,
            timerInterval: null
        };

        // Default configuration
        const defaultConfig = {
            game_title: "Jack And Jill",
            subtitle: "Mathletica: Đố vui không thưởng #12",
            player_name_placeholder: "Nhập tên của bạn..."
        };

        // Element SDK implementation
        const element = {
            defaultConfig: defaultConfig,
            onConfigChange: async (config) => {
                const gameTitle = document.getElementById('gameTitle');
                const gameSubtitle = document.getElementById('gameSubtitle');
                const playerNameInput = document.getElementById('playerNameInput');

                if (gameTitle) {
                    gameTitle.textContent = config.game_title || defaultConfig.game_title;
                }
                if (gameSubtitle) {
                    gameSubtitle.textContent = config.subtitle || defaultConfig.subtitle;
                }
                if (playerNameInput) {
                    playerNameInput.placeholder = config.player_name_placeholder || defaultConfig.player_name_placeholder;
                }
            },
            mapToCapabilities: (config) => ({
                recolorables: [],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            }),
            mapToEditPanelValues: (config) => new Map([
                ["game_title", config.game_title || defaultConfig.game_title],
                ["subtitle", config.subtitle || defaultConfig.subtitle],
                ["player_name_placeholder", config.player_name_placeholder || defaultConfig.player_name_placeholder]
            ])
        };

        // Initialize Element SDK
        if (window.elementSdk) {
            window.elementSdk.init(element);
        }

        function startGame() {
            const nameInput = document.getElementById('playerNameInput');
            gameState.playerName = nameInput.value.trim() || 'Bạn';
            
            document.getElementById('playerName').textContent = gameState.playerName;
            
            // Smooth page transition
            const welcomePage = document.getElementById('welcomePage');
            const gamePage = document.getElementById('gamePage');
            
            welcomePage.classList.add('fade-out');
            
            setTimeout(() => {
                welcomePage.classList.remove('active', 'fade-out');
                gamePage.classList.add('active');
            }, 400);
            
            // Start timer
            gameState.startTime = Date.now();
            gameState.timerInterval = setInterval(updateTimer, 1000);
            
            // Reset buckets
            gameState.bucket3 = 0;
            gameState.bucket5 = 0;
            updateBucketDisplay();
            
            // Add pulse effect to helpful buttons
            setTimeout(() => {
                addHintPulse();
            }, 2000);
        }

        function updateTimer() {
            if (!gameState.startTime) return;
            
            const elapsed = Math.floor((Date.now() - gameState.startTime) / 1000);
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            
            const timeString = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('gameTimer').textContent = timeString;
        }

        function fillBucket(size) {
            if (size === 3) {
                gameState.bucket3 = 3;
            } else if (size === 5) {
                gameState.bucket5 = 5;
            }
            updateBucketDisplay(size);
            checkVictory();
        }

        function emptyBucket(size) {
            if (size === 3) {
                gameState.bucket3 = 0;
            } else if (size === 5) {
                gameState.bucket5 = 0;
            }
            updateBucketDisplay(size);
        }

        function pourWater(from, to) {
            let changedBucket = null;
            
            if (from === 3 && to === 5) {
                // Pour from 3L to 5L
                const canPour = Math.min(gameState.bucket3, 5 - gameState.bucket5);
                if (canPour > 0) {
                    gameState.bucket3 -= canPour;
                    gameState.bucket5 += canPour;
                    changedBucket = 5; // Focus on the receiving bucket
                }
            } else if (from === 5 && to === 3) {
                // Pour from 5L to 3L
                const canPour = Math.min(gameState.bucket5, 3 - gameState.bucket3);
                if (canPour > 0) {
                    gameState.bucket5 -= canPour;
                    gameState.bucket3 += canPour;
                    changedBucket = 3; // Focus on the receiving bucket
                }
            }
            
            updateBucketDisplay(changedBucket);
            checkVictory();
        }

        function updateBucketDisplay(changedBucket = null) {
            // Update 3L bucket
            const bucket3Amount = document.getElementById('bucket3Amount');
            const bucket3Capacity = bucket3Amount.parentElement;
            const bucket3Visual = document.querySelector('.bucket:first-child .bucket-visual');
            
            bucket3Amount.textContent = gameState.bucket3;
            const water3 = document.getElementById('bucket3Water');
            water3.style.height = `${(gameState.bucket3 / 3) * 100}%`;
            
            // Update 5L bucket
            const bucket5Amount = document.getElementById('bucket5Amount');
            const bucket5Capacity = bucket5Amount.parentElement;
            const bucket5Visual = document.querySelector('.bucket:last-child .bucket-visual');
            
            bucket5Amount.textContent = gameState.bucket5;
            const water5 = document.getElementById('bucket5Water');
            water5.style.height = `${(gameState.bucket5 / 5) * 100}%`;
            
            // Add animation for changed bucket
            if (changedBucket === 3) {
                bucket3Capacity.classList.add('changed');
                bucket3Visual.classList.add('changed');
                setTimeout(() => {
                    bucket3Capacity.classList.remove('changed');
                    bucket3Visual.classList.remove('changed');
                }, 600);
            } else if (changedBucket === 5) {
                bucket5Capacity.classList.add('changed');
                bucket5Visual.classList.add('changed');
                setTimeout(() => {
                    bucket5Capacity.classList.remove('changed');
                    bucket5Visual.classList.remove('changed');
                }, 600);
            }
            
            // Remove pulse from all buttons and add to relevant ones
            removeAllPulse();
            setTimeout(() => {
                addHintPulse();
            }, 800);
        }

        function checkVictory() {
            if (gameState.bucket3 + gameState.bucket5 === 7) {
                // Stop timer
                if (gameState.timerInterval) {
                    clearInterval(gameState.timerInterval);
                }
                
                // Show victory modal
                document.getElementById('victoryPlayerName').textContent = gameState.playerName;
                document.getElementById('victoryTime').textContent = document.getElementById('gameTimer').textContent;
                document.getElementById('victoryModal').style.display = 'flex';
            }
        }



        // Helper functions for button animations
        function addHintPulse() {
            // Add pulse to helpful buttons based on current state
            const buttons = document.querySelectorAll('.action-btn');
            
            // Remove existing pulse
            buttons.forEach(btn => btn.classList.remove('pulse'));
            
            // Add strategic hints based on game state
            if (gameState.bucket3 === 0 && gameState.bucket5 === 0) {
                // Start: suggest filling 5L bucket
                buttons[1].classList.add('pulse'); // Fill 5L button
            } else if (gameState.bucket3 === 0 && gameState.bucket5 === 5) {
                // Next: pour from 5L to 3L
                buttons[5].classList.add('pulse'); // Pour 5L to 3L
            } else if (gameState.bucket3 === 3 && gameState.bucket5 === 2) {
                // Empty 3L bucket
                buttons[2].classList.add('pulse'); // Empty 3L
            } else if (gameState.bucket3 === 0 && gameState.bucket5 === 2) {
                // Pour from 5L to 3L
                buttons[5].classList.add('pulse'); // Pour 5L to 3L
            } else if (gameState.bucket3 === 2 && gameState.bucket5 === 0) {
                // Fill 5L bucket
                buttons[1].classList.add('pulse'); // Fill 5L
            }
        }
        
        function removeAllPulse() {
            const buttons = document.querySelectorAll('.action-btn');
            buttons.forEach(btn => btn.classList.remove('pulse'));
        }

        function resetGame() {
            // Hide victory modal
            document.getElementById('victoryModal').style.display = 'none';
            
            // Reset game state
            gameState.bucket3 = 0;
            gameState.bucket5 = 0;
            gameState.startTime = null;
            
            if (gameState.timerInterval) {
                clearInterval(gameState.timerInterval);
            }
            
            // Reset display
            document.getElementById('gameTimer').textContent = '00:00';
            updateBucketDisplay();
            
            // Smooth transition back to welcome page
            const gamePage = document.getElementById('gamePage');
            const welcomePage = document.getElementById('welcomePage');
            
            gamePage.classList.add('fade-out');
            
            setTimeout(() => {
                gamePage.classList.remove('active', 'fade-out');
                welcomePage.classList.add('active');
            }, 400);
            
            // Clear name input
            document.getElementById('playerNameInput').value = '';
            
            // Remove all pulse effects
            removeAllPulse();
        }

        // Initialize display
        updateBucketDisplay();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9972253ca526fdf7',t:'MTc2MTkwMzE0OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>